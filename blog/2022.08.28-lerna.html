<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed"><title data-react-helmet="true">2022.08.28-lerna | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://jiaozitang.github.io/blog/2022.08.28-lerna"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="2022.08.28-lerna | My Site"><meta data-react-helmet="true" name="description" content="携手创作，共同成长！这是我参与「掘金日新计划 · 8 月更文挑战」的第 2 天，点击查看活动详情"><meta data-react-helmet="true" property="og:description" content="携手创作，共同成长！这是我参与「掘金日新计划 · 8 月更文挑战」的第 2 天，点击查看活动详情"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-10-12T07:21:45.906Z"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://jiaozitang.github.io/blog/2022.08.28-lerna"><link data-react-helmet="true" rel="alternate" href="https://jiaozitang.github.io/blog/2022.08.28-lerna" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://jiaozitang.github.io/blog/2022.08.28-lerna" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.1098517f.css">
<link rel="preload" href="/assets/js/runtime~main.8b388713.js" as="script">
<link rel="preload" href="/assets/js/main.c7c69549.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/front-end/code">前端</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jiaozitang/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">All posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.07.31-devtools2">一些有用的 JavaScript 调试技巧</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.08.14-hooks">2022.08.14-hooks</a></li><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/blog/2022.08.28-lerna">2022.08.28-lerna</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.6.13-module-federation">浅学一下 webpack5 module federation</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.06.24-storybook">浅学一下 storybook</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.07.30-devtools1">2022.07.30-devtools1</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/05/23/ts">Typescript 常用特性小结</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/03/12/function-code">JavaScript 函数式编程-入门篇</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/02/12/React-Hooks">React-你有完全了解 Hooks 吗</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/02/11/up-up-up">专栏学习心得《大厂晋升指南》</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/01/31/【译】你知道 Code Review 应该检查哪些问题吗">【译】你知道 Code Review 应该检查哪些问题吗</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/实践指南-快速搭建文档系统">实践指南-快速搭建文档系统</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/12/20/how-to-join-Taro">如何参与大型开源项目-Taro 共建</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/07/22/simple-react">手写系列-实现一个铂金段位的 React</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">2022.08.28-lerna</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-10-12T07:21:45.906Z" itemprop="datePublished">October 12, 2022</time> · <!-- -->10 min read</div></header><div class="markdown" itemprop="articleBody"><p>携手创作，共同成长！这是我参与「掘金日新计划 · 8 月更文挑战」的第 2 天，点击<a href="https://juejin.cn/post/7123120819437322247" target="_blank" rel="noopener noreferrer">查看活动详情</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="一背景">一、背景<a class="hash-link" href="#一背景" title="Direct link to heading">​</a></h2><p>或许在开发多包的过程中，总会遇到多包的发布工作流问题，详细解释就是一个 npm 包，由多个 npm 相互依赖构成，发布 npm 包 1，对其有依赖的 npm 包 2 也要一同发布，那么怎么才能将这个发布工作流简单化呢？</p><p>实现在发布 npm 包 1 时，自动检测依赖 npm 包的其他包，并同时发布，更新版本。</p><p>答案大家都知晓，那便是使用多包管理工具 lerna。</p><p>但是 lerna 官方文档(<a href="https://www.lernajs.cn/" target="_blank" rel="noopener noreferrer">lerna 中文文档</a>)不齐全，学习成本甚高，本文欲打造一个最详细的 lerna 手册，帮助查阅指令，熟悉 lerna。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="二lerna-介绍">二、lerna 介绍<a class="hash-link" href="#二lerna-介绍" title="Direct link to heading">​</a></h2><p>lerna 是一个优化使用 git 和 npm 管理多包存储库工作流的工具。</p><p>它具有以下功能：</p><ul><li>自动解决 packages 之间的依赖关系；</li><li>通过 git 检测文件改动，自动发布；</li><li>根据 git 提交记录，自动生成 CHANGELOG。</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="三工作模式">三、工作模式<a class="hash-link" href="#三工作模式" title="Direct link to heading">​</a></h2><p>lerna 支持 2 种工作模式，分别是<strong>默认模式-Locked mode</strong>和<strong>Independent mode</strong>。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="默认模式-locked-mode">默认模式-Locked mode<a class="hash-link" href="#默认模式-locked-mode" title="Direct link to heading">​</a></h3><p>每次发布，所有有改动的包自动更新版本号，所有包的版本一致，版本号维护在 lerna.json 的 version 中。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="independent-mode">Independent mode<a class="hash-link" href="#independent-mode" title="Direct link to heading">​</a></h3><p>每次发布时，将提示每个已更改的包，以及其建议的版本号，每个 package 都有自己的版本号。</p><p>设置方式：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna init --independent</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>或修改 lerna.json：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">version: </span><span class="token string" style="color:#e3116c">&quot;independent&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="四常用指令">四、常用指令<a class="hash-link" href="#四常用指令" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="1-lerna-init">1. lerna init<a class="hash-link" href="#1-lerna-init" title="Direct link to heading">​</a></h3><p>初始化一个 lerna 工程或者升级现有 lerna 项目到当前版本的 lerna。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna init</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>执行成功后，目录下将会生成这样的目录结构。</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"> - packages(目录)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - lerna.json(配置文件)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - package.json(工程描述文件)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="2-lerna-create">2. lerna create<a class="hash-link" href="#2-lerna-create" title="Direct link to heading">​</a></h3><p>创建一个 package，指定包名，可指定包位置。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna create </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">location</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna create package1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna create package1.1 packages/package1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="3-lerna-add">3. lerna add<a class="hash-link" href="#3-lerna-add" title="Direct link to heading">​</a></h3><p>为包添加依赖。</p><ul><li><code>--dev</code> devDependencies 替代 <code>dependencies</code></li><li><code>--exact</code> 安装准确版本，就是安装的包版本前面不带<code>^</code>, Eg: <code>&quot;^2.20.0&quot; ➜ &quot;2.20.0&quot;</code></li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> lodash packages/module-1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="4-lerna-bootstrap">4. lerna bootstrap<a class="hash-link" href="#4-lerna-bootstrap" title="Direct link to heading">​</a></h3><p>将本地包链接在一起并安装其余的包依赖项。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna bootstrap</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="5-lerna-list">5. lerna list<a class="hash-link" href="#5-lerna-list" title="Direct link to heading">​</a></h3><p>列出所有的包。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna list</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="6-lerna-import">6. lerna import<a class="hash-link" href="#6-lerna-import" title="Direct link to heading">​</a></h3><p>导入本地已经存在的包。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna </span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">npm 包所在路径</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="7-lerna-link">7. lerna link<a class="hash-link" href="#7-lerna-link" title="Direct link to heading">​</a></h3><p>项目包建立软链，类似 npm link。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna </span><span class="token function" style="color:#d73a49">link</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="8-lerna-clean">8. lerna clean<a class="hash-link" href="#8-lerna-clean" title="Direct link to heading">​</a></h3><p>删除所有包的 node_modules 目录。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna clean</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="9-lerna-changed">9. lerna changed<a class="hash-link" href="#9-lerna-changed" title="Direct link to heading">​</a></h3><p>列出自上次更改后已更改的本地包。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna changed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="10-lerna-publish">10. lerna publish<a class="hash-link" href="#10-lerna-publish" title="Direct link to heading">​</a></h3><p>发布包。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna publish</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="11-lerna-diff">11. lerna diff<a class="hash-link" href="#11-lerna-diff" title="Direct link to heading">​</a></h3><p>区分自上次发布以来的所有包或单个包</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna </span><span class="token function" style="color:#d73a49">diff</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="12-lerna-info">12. lerna info<a class="hash-link" href="#12-lerna-info" title="Direct link to heading">​</a></h3><p>打印有关本地环境的调试信息。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna info</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="13-lerna-run">13. lerna run<a class="hash-link" href="#13-lerna-run" title="Direct link to heading">​</a></h3><p>在包含该脚本的每个包中运行 npm 脚本。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna run dev</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>在包含该脚本的指定包中运行 npm 脚本。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna run dev --scope</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">packageA</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="14-lerna-version">14. lerna version<a class="hash-link" href="#14-lerna-version" title="Direct link to heading">​</a></h3><p>更新版本。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna version</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="五lerna--yarn-workspaces-实践">五、lerna + yarn workspaces 实践<a class="hash-link" href="#五lerna--yarn-workspaces-实践" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="1-安装">1. 安装<a class="hash-link" href="#1-安装" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> lerna -g</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="2-创建项目">2. 创建项目<a class="hash-link" href="#2-创建项目" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> lerna-demo</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="3-初始化项目">3. 初始化项目<a class="hash-link" href="#3-初始化项目" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> ./lerna-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna init</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>其中 package.json &amp; lerna.json 如下:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">// package.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;private&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true, // 私有的，不会被发布，是管理整个项目，与要发布到npm的解耦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;devDependencies&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;lerna&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^4.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// lerna.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;packages&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;packages/*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;version&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="4-启用-yarn-workspaces">4. 启用 yarn workspaces<a class="hash-link" href="#4-启用-yarn-workspaces" title="Direct link to heading">​</a></h3><p>各个库之间存在依赖，如 A 依赖于 B，因此我们通常需要将 B link 到 A 的 node_module 里，一旦仓库很多的话，手动的管理这些 link 操作负担很大，因此需要自动化的 link 操作，按照拓扑排序将各个依赖进行 link。</p><p>启用 yarn workspaces 可以把所有的依赖提升到顶层的 node_modules 中，并且在 node_modules 中链接到本地的 package，自动的帮忙解决安装和 link 问题。</p><p>修改 package.json：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;private&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true, // 只有私有项目可以开启</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;workspaces&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;packages/*&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>修改 lerna.json：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;useWorkspaces&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;npmClient&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;yarn&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="5-添加-package">5. 添加 package<a class="hash-link" href="#5-添加-package" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna create packageA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna create packageB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="6-添加删除清除包依赖">6. 添加、删除、清除包依赖<a class="hash-link" href="#6-添加删除清除包依赖" title="Direct link to heading">​</a></h3><p>yarn workspaces 添加依赖：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 将packageA作为packageB的依赖进行安装：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspace packageB </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> packageA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 给所有的package安装依赖:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspaces </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> lodash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 给root 安装依赖：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> -W -D typescript</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>yarn workspaces 删除依赖：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 删除packageB的依赖packageA：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspace packageB remove packageA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 给所有的packages删除依赖:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspaces remove lodash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 给root 删除依赖：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> remove -W -D typescript</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>yarn workspaces 安装全部依赖：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>yarn install</code> 等价于 <code>lerna bootstrap --npm-client yarn --use-workspaces</code>，把所有的依赖提升到顶层的 node_modules 中，并且在 node_modules 中链接到本地的 package，自动的帮忙解决安装和 link 问题。</p><p>yarn workspaces 清除 node_modules：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspaces run clean</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="7-项目构建">7. 项目构建<a class="hash-link" href="#7-项目构建" title="Direct link to heading">​</a></h3><p>构建所有包：</p><p>区别于普通项目之处在于各个 package 之间存在相互依赖，如 packageB 只有在 packageA 构建完之后才能进行构建，否则就会出错，这实际上要求我们以一种拓扑排序的规则进行构建。</p><p>lerna 支持按照拓扑排序规则执行命令, --sort 参数可以控制以拓扑排序规则执行命令。</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 以拓扑排序规则在包含该脚本的每个包中运行 npm run dev 脚本。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna run dev --stream --sort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 以拓扑排序规则在包含该脚本的每个包中运行 npm run build 脚本。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna run build --stream --sort</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>构建指定包：</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 在 packageA 包中运行 npm run dev 脚本。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna run dev --stream --scope</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">packageA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 在 packageA 包中运行 npm run build 脚本。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna run build --stream --scope</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">packageA</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="8-发布">8. 发布<a class="hash-link" href="#8-发布" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna publish</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>发布指令 lerna publish 内置以下步骤：</p><ul><li><p><strong>条件验证</strong>：包含验证测试是否通过，是否存在未提交的代码，是否在主分支上进行版本发布操作等等条件验证；</p></li><li><p><strong>version_bump</strong>：发版的时候需要更新版本号，这时候如何更新版本号就是个问题，一般大家都会遵循  semVer 语义；</p></li><li><p><strong>生成 changelog</strong>：为了方便查看每个 package 每个版本解决了哪些功能，我们需要给每个 package 都生成一份 changelog 方便用户查看各个版本的功能变化；</p></li><li><p><strong>生成 git tag</strong>：为了方便后续回滚问题及问题排查通常需要给每个版本创建一个 git tag；</p></li><li><p><strong>git 发布版本</strong>：每次发版我们都需要单独生成一个 commit 记录来标记 milestone；</p></li><li><p><strong>发布 npm 包</strong>：发布完 git 后我们还需要将更新的版本发布到 npm 上，以便外部用户使用。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="小结">小结<a class="hash-link" href="#小结" title="Direct link to heading">​</a></h2><p>本文从 5 个方面介绍了 lerna：</p><ul><li>背景</li><li>介绍</li><li>工作模式</li><li>常用指令</li><li>lerna + yarn workspaces 实践</li></ul><p>相信你已经很熟悉 lerna 的使用了，下方还列举了参考资料，可以自行扩展阅读。</p><p>希望能对你有所帮助，感谢阅读～</p><p>别忘了点个赞鼓励一下我哦，笔芯 ❤️</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="参考资料">参考资料<a class="hash-link" href="#参考资料" title="Direct link to heading">​</a></h2><ul><li><a href="https://juejin.cn/post/6844903568751722509" target="_blank" rel="noopener noreferrer">lerna 管理前端模块最佳实践</a></li><li><a href="https://juejin.cn/post/6844903856153821198" target="_blank" rel="noopener noreferrer">Lerna 中文教程详解</a></li><li><a href="https://www.lernajs.cn/" target="_blank" rel="noopener noreferrer">Lerna 中文官网</a></li><li><a href="https://segmentfault.com/a/1190000023954051" target="_blank" rel="noopener noreferrer">Lerna --多包存储管理工具（一）</a></li><li><a href="https://juejin.cn/post/7043998041786810398" target="_blank" rel="noopener noreferrer">One For All：基于 pnpm + lerna + typescript 的最佳项目实践 - 理论篇</a></li><li><a href="https://juejin.cn/post/6844903918279852046" target="_blank" rel="noopener noreferrer">lerna+yarn workspace+monorepo 项目的最佳实践</a></li><li><a href="https://juejin.cn/post/6847902224987717639" target="_blank" rel="noopener noreferrer">@lerna/run(翻译)</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022.08.14-hooks"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« <!-- -->2022.08.14-hooks</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022.6.13-module-federation"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">浅学一下 webpack5 module federation<!-- --> »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一背景" class="table-of-contents__link toc-highlight">一、背景</a></li><li><a href="#二lerna-介绍" class="table-of-contents__link toc-highlight">二、lerna 介绍</a></li><li><a href="#三工作模式" class="table-of-contents__link toc-highlight">三、工作模式</a><ul><li><a href="#默认模式-locked-mode" class="table-of-contents__link toc-highlight">默认模式-Locked mode</a></li><li><a href="#independent-mode" class="table-of-contents__link toc-highlight">Independent mode</a></li></ul></li><li><a href="#四常用指令" class="table-of-contents__link toc-highlight">四、常用指令</a><ul><li><a href="#1-lerna-init" class="table-of-contents__link toc-highlight">1. lerna init</a></li><li><a href="#2-lerna-create" class="table-of-contents__link toc-highlight">2. lerna create</a></li><li><a href="#3-lerna-add" class="table-of-contents__link toc-highlight">3. lerna add</a></li><li><a href="#4-lerna-bootstrap" class="table-of-contents__link toc-highlight">4. lerna bootstrap</a></li><li><a href="#5-lerna-list" class="table-of-contents__link toc-highlight">5. lerna list</a></li><li><a href="#6-lerna-import" class="table-of-contents__link toc-highlight">6. lerna import</a></li><li><a href="#7-lerna-link" class="table-of-contents__link toc-highlight">7. lerna link</a></li><li><a href="#8-lerna-clean" class="table-of-contents__link toc-highlight">8. lerna clean</a></li><li><a href="#9-lerna-changed" class="table-of-contents__link toc-highlight">9. lerna changed</a></li><li><a href="#10-lerna-publish" class="table-of-contents__link toc-highlight">10. lerna publish</a></li><li><a href="#11-lerna-diff" class="table-of-contents__link toc-highlight">11. lerna diff</a></li><li><a href="#12-lerna-info" class="table-of-contents__link toc-highlight">12. lerna info</a></li><li><a href="#13-lerna-run" class="table-of-contents__link toc-highlight">13. lerna run</a></li><li><a href="#14-lerna-version" class="table-of-contents__link toc-highlight">14. lerna version</a></li></ul></li><li><a href="#五lerna--yarn-workspaces-实践" class="table-of-contents__link toc-highlight">五、lerna + yarn workspaces 实践</a><ul><li><a href="#1-安装" class="table-of-contents__link toc-highlight">1. 安装</a></li><li><a href="#2-创建项目" class="table-of-contents__link toc-highlight">2. 创建项目</a></li><li><a href="#3-初始化项目" class="table-of-contents__link toc-highlight">3. 初始化项目</a></li><li><a href="#4-启用-yarn-workspaces" class="table-of-contents__link toc-highlight">4. 启用 yarn workspaces</a></li><li><a href="#5-添加-package" class="table-of-contents__link toc-highlight">5. 添加 package</a></li><li><a href="#6-添加删除清除包依赖" class="table-of-contents__link toc-highlight">6. 添加、删除、清除包依赖</a></li><li><a href="#7-项目构建" class="table-of-contents__link toc-highlight">7. 项目构建</a></li><li><a href="#8-发布" class="table-of-contents__link toc-highlight">8. 发布</a></li></ul></li><li><a href="#小结" class="table-of-contents__link toc-highlight">小结</a></li><li><a href="#参考资料" class="table-of-contents__link toc-highlight">参考资料</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8b388713.js"></script>
<script src="/assets/js/main.c7c69549.js"></script>
</body>
</html>