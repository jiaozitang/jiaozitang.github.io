<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed"><title data-react-helmet="true">2022.08.28-lerna | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://jiaozitang.github.io/blog/2022.08.28-lerna"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="2022.08.28-lerna | My Site"><meta data-react-helmet="true" name="description" content="æºæ‰‹åˆ›ä½œï¼Œå…±åŒæˆé•¿ï¼è¿™æ˜¯æˆ‘å‚ä¸ã€Œæ˜é‡‘æ—¥æ–°è®¡åˆ’ Â· 8 æœˆæ›´æ–‡æŒ‘æˆ˜ã€çš„ç¬¬ 2 å¤©ï¼Œç‚¹å‡»æŸ¥çœ‹æ´»åŠ¨è¯¦æƒ…"><meta data-react-helmet="true" property="og:description" content="æºæ‰‹åˆ›ä½œï¼Œå…±åŒæˆé•¿ï¼è¿™æ˜¯æˆ‘å‚ä¸ã€Œæ˜é‡‘æ—¥æ–°è®¡åˆ’ Â· 8 æœˆæ›´æ–‡æŒ‘æˆ˜ã€çš„ç¬¬ 2 å¤©ï¼Œç‚¹å‡»æŸ¥çœ‹æ´»åŠ¨è¯¦æƒ…"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-10-12T07:21:45.906Z"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://jiaozitang.github.io/blog/2022.08.28-lerna"><link data-react-helmet="true" rel="alternate" href="https://jiaozitang.github.io/blog/2022.08.28-lerna" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://jiaozitang.github.io/blog/2022.08.28-lerna" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.1098517f.css">
<link rel="preload" href="/assets/js/runtime~main.8b388713.js" as="script">
<link rel="preload" href="/assets/js/main.c7c69549.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/front-end/code">å‰ç«¯</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jiaozitang/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ğŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ğŸŒ</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">All posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.07.31-devtools2">ä¸€äº›æœ‰ç”¨çš„ JavaScript è°ƒè¯•æŠ€å·§</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.08.14-hooks">2022.08.14-hooks</a></li><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/blog/2022.08.28-lerna">2022.08.28-lerna</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.6.13-module-federation">æµ…å­¦ä¸€ä¸‹ webpack5 module federation</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.06.24-storybook">æµ…å­¦ä¸€ä¸‹ storybook</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022.07.30-devtools1">2022.07.30-devtools1</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/05/23/ts">Typescript å¸¸ç”¨ç‰¹æ€§å°ç»“</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/03/12/function-code">JavaScript å‡½æ•°å¼ç¼–ç¨‹-å…¥é—¨ç¯‡</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/02/12/React-Hooks">React-ä½ æœ‰å®Œå…¨äº†è§£ Hooks å—</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/02/11/up-up-up">ä¸“æ å­¦ä¹ å¿ƒå¾—ã€Šå¤§å‚æ™‹å‡æŒ‡å—ã€‹</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/01/31/ã€è¯‘ã€‘ä½ çŸ¥é“ Code Review åº”è¯¥æ£€æŸ¥å“ªäº›é—®é¢˜å—">ã€è¯‘ã€‘ä½ çŸ¥é“ Code Review åº”è¯¥æ£€æŸ¥å“ªäº›é—®é¢˜å—</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/å®è·µæŒ‡å—-å¿«é€Ÿæ­å»ºæ–‡æ¡£ç³»ç»Ÿ">å®è·µæŒ‡å—-å¿«é€Ÿæ­å»ºæ–‡æ¡£ç³»ç»Ÿ</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/12/20/how-to-join-Taro">å¦‚ä½•å‚ä¸å¤§å‹å¼€æºé¡¹ç›®-Taro å…±å»º</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/07/22/simple-react">æ‰‹å†™ç³»åˆ—-å®ç°ä¸€ä¸ªé“‚é‡‘æ®µä½çš„ React</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">2022.08.28-lerna</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-10-12T07:21:45.906Z" itemprop="datePublished">October 12, 2022</time> Â· <!-- -->10 min read</div></header><div class="markdown" itemprop="articleBody"><p>æºæ‰‹åˆ›ä½œï¼Œå…±åŒæˆé•¿ï¼è¿™æ˜¯æˆ‘å‚ä¸ã€Œæ˜é‡‘æ—¥æ–°è®¡åˆ’ Â· 8 æœˆæ›´æ–‡æŒ‘æˆ˜ã€çš„ç¬¬ 2 å¤©ï¼Œç‚¹å‡»<a href="https://juejin.cn/post/7123120819437322247" target="_blank" rel="noopener noreferrer">æŸ¥çœ‹æ´»åŠ¨è¯¦æƒ…</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ä¸€èƒŒæ™¯">ä¸€ã€èƒŒæ™¯<a class="hash-link" href="#ä¸€èƒŒæ™¯" title="Direct link to heading">â€‹</a></h2><p>æˆ–è®¸åœ¨å¼€å‘å¤šåŒ…çš„è¿‡ç¨‹ä¸­ï¼Œæ€»ä¼šé‡åˆ°å¤šåŒ…çš„å‘å¸ƒå·¥ä½œæµé—®é¢˜ï¼Œè¯¦ç»†è§£é‡Šå°±æ˜¯ä¸€ä¸ª npm åŒ…ï¼Œç”±å¤šä¸ª npm ç›¸äº’ä¾èµ–æ„æˆï¼Œå‘å¸ƒ npm åŒ… 1ï¼Œå¯¹å…¶æœ‰ä¾èµ–çš„ npm åŒ… 2 ä¹Ÿè¦ä¸€åŒå‘å¸ƒï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰èƒ½å°†è¿™ä¸ªå‘å¸ƒå·¥ä½œæµç®€å•åŒ–å‘¢ï¼Ÿ</p><p>å®ç°åœ¨å‘å¸ƒ npm åŒ… 1 æ—¶ï¼Œè‡ªåŠ¨æ£€æµ‹ä¾èµ– npm åŒ…çš„å…¶ä»–åŒ…ï¼Œå¹¶åŒæ—¶å‘å¸ƒï¼Œæ›´æ–°ç‰ˆæœ¬ã€‚</p><p>ç­”æ¡ˆå¤§å®¶éƒ½çŸ¥æ™“ï¼Œé‚£ä¾¿æ˜¯ä½¿ç”¨å¤šåŒ…ç®¡ç†å·¥å…· lernaã€‚</p><p>ä½†æ˜¯ lerna å®˜æ–¹æ–‡æ¡£(<a href="https://www.lernajs.cn/" target="_blank" rel="noopener noreferrer">lerna ä¸­æ–‡æ–‡æ¡£</a>)ä¸é½å…¨ï¼Œå­¦ä¹ æˆæœ¬ç”šé«˜ï¼Œæœ¬æ–‡æ¬²æ‰“é€ ä¸€ä¸ªæœ€è¯¦ç»†çš„ lerna æ‰‹å†Œï¼Œå¸®åŠ©æŸ¥é˜…æŒ‡ä»¤ï¼Œç†Ÿæ‚‰ lernaã€‚</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="äºŒlerna-ä»‹ç»">äºŒã€lerna ä»‹ç»<a class="hash-link" href="#äºŒlerna-ä»‹ç»" title="Direct link to heading">â€‹</a></h2><p>lerna æ˜¯ä¸€ä¸ªä¼˜åŒ–ä½¿ç”¨ git å’Œ npm ç®¡ç†å¤šåŒ…å­˜å‚¨åº“å·¥ä½œæµçš„å·¥å…·ã€‚</p><p>å®ƒå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>è‡ªåŠ¨è§£å†³ packages ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼›</li><li>é€šè¿‡ git æ£€æµ‹æ–‡ä»¶æ”¹åŠ¨ï¼Œè‡ªåŠ¨å‘å¸ƒï¼›</li><li>æ ¹æ® git æäº¤è®°å½•ï¼Œè‡ªåŠ¨ç”Ÿæˆ CHANGELOGã€‚</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ä¸‰å·¥ä½œæ¨¡å¼">ä¸‰ã€å·¥ä½œæ¨¡å¼<a class="hash-link" href="#ä¸‰å·¥ä½œæ¨¡å¼" title="Direct link to heading">â€‹</a></h2><p>lerna æ”¯æŒ 2 ç§å·¥ä½œæ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯<strong>é»˜è®¤æ¨¡å¼-Locked mode</strong>å’Œ<strong>Independent mode</strong>ã€‚</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="é»˜è®¤æ¨¡å¼-locked-mode">é»˜è®¤æ¨¡å¼-Locked mode<a class="hash-link" href="#é»˜è®¤æ¨¡å¼-locked-mode" title="Direct link to heading">â€‹</a></h3><p>æ¯æ¬¡å‘å¸ƒï¼Œæ‰€æœ‰æœ‰æ”¹åŠ¨çš„åŒ…è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·ï¼Œæ‰€æœ‰åŒ…çš„ç‰ˆæœ¬ä¸€è‡´ï¼Œç‰ˆæœ¬å·ç»´æŠ¤åœ¨ lerna.json çš„ version ä¸­ã€‚</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="independent-mode">Independent mode<a class="hash-link" href="#independent-mode" title="Direct link to heading">â€‹</a></h3><p>æ¯æ¬¡å‘å¸ƒæ—¶ï¼Œå°†æç¤ºæ¯ä¸ªå·²æ›´æ”¹çš„åŒ…ï¼Œä»¥åŠå…¶å»ºè®®çš„ç‰ˆæœ¬å·ï¼Œæ¯ä¸ª package éƒ½æœ‰è‡ªå·±çš„ç‰ˆæœ¬å·ã€‚</p><p>è®¾ç½®æ–¹å¼ï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna init --independent</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æˆ–ä¿®æ”¹ lerna.jsonï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">version: </span><span class="token string" style="color:#e3116c">&quot;independent&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="å››å¸¸ç”¨æŒ‡ä»¤">å››ã€å¸¸ç”¨æŒ‡ä»¤<a class="hash-link" href="#å››å¸¸ç”¨æŒ‡ä»¤" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="1-lerna-init">1. lerna init<a class="hash-link" href="#1-lerna-init" title="Direct link to heading">â€‹</a></h3><p>åˆå§‹åŒ–ä¸€ä¸ª lerna å·¥ç¨‹æˆ–è€…å‡çº§ç°æœ‰ lerna é¡¹ç›®åˆ°å½“å‰ç‰ˆæœ¬çš„ lernaã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna init</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æ‰§è¡ŒæˆåŠŸåï¼Œç›®å½•ä¸‹å°†ä¼šç”Ÿæˆè¿™æ ·çš„ç›®å½•ç»“æ„ã€‚</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"> - packages(ç›®å½•)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - lerna.json(é…ç½®æ–‡ä»¶)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - package.json(å·¥ç¨‹æè¿°æ–‡ä»¶)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="2-lerna-create">2. lerna create<a class="hash-link" href="#2-lerna-create" title="Direct link to heading">â€‹</a></h3><p>åˆ›å»ºä¸€ä¸ª packageï¼ŒæŒ‡å®šåŒ…åï¼Œå¯æŒ‡å®šåŒ…ä½ç½®ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna create </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">location</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna create package1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna create package1.1 packages/package1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="3-lerna-add">3. lerna add<a class="hash-link" href="#3-lerna-add" title="Direct link to heading">â€‹</a></h3><p>ä¸ºåŒ…æ·»åŠ ä¾èµ–ã€‚</p><ul><li><code>--dev</code> devDependencies æ›¿ä»£ <code>dependencies</code></li><li><code>--exact</code> å®‰è£…å‡†ç¡®ç‰ˆæœ¬ï¼Œå°±æ˜¯å®‰è£…çš„åŒ…ç‰ˆæœ¬å‰é¢ä¸å¸¦<code>^</code>, Eg: <code>&quot;^2.20.0&quot; âœ &quot;2.20.0&quot;</code></li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> lodash packages/module-1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="4-lerna-bootstrap">4. lerna bootstrap<a class="hash-link" href="#4-lerna-bootstrap" title="Direct link to heading">â€‹</a></h3><p>å°†æœ¬åœ°åŒ…é“¾æ¥åœ¨ä¸€èµ·å¹¶å®‰è£…å…¶ä½™çš„åŒ…ä¾èµ–é¡¹ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna bootstrap</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="5-lerna-list">5. lerna list<a class="hash-link" href="#5-lerna-list" title="Direct link to heading">â€‹</a></h3><p>åˆ—å‡ºæ‰€æœ‰çš„åŒ…ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna list</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="6-lerna-import">6. lerna import<a class="hash-link" href="#6-lerna-import" title="Direct link to heading">â€‹</a></h3><p>å¯¼å…¥æœ¬åœ°å·²ç»å­˜åœ¨çš„åŒ…ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna </span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">npm åŒ…æ‰€åœ¨è·¯å¾„</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="7-lerna-link">7. lerna link<a class="hash-link" href="#7-lerna-link" title="Direct link to heading">â€‹</a></h3><p>é¡¹ç›®åŒ…å»ºç«‹è½¯é“¾ï¼Œç±»ä¼¼ npm linkã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna </span><span class="token function" style="color:#d73a49">link</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="8-lerna-clean">8. lerna clean<a class="hash-link" href="#8-lerna-clean" title="Direct link to heading">â€‹</a></h3><p>åˆ é™¤æ‰€æœ‰åŒ…çš„ node_modules ç›®å½•ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna clean</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="9-lerna-changed">9. lerna changed<a class="hash-link" href="#9-lerna-changed" title="Direct link to heading">â€‹</a></h3><p>åˆ—å‡ºè‡ªä¸Šæ¬¡æ›´æ”¹åå·²æ›´æ”¹çš„æœ¬åœ°åŒ…ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna changed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="10-lerna-publish">10. lerna publish<a class="hash-link" href="#10-lerna-publish" title="Direct link to heading">â€‹</a></h3><p>å‘å¸ƒåŒ…ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna publish</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="11-lerna-diff">11. lerna diff<a class="hash-link" href="#11-lerna-diff" title="Direct link to heading">â€‹</a></h3><p>åŒºåˆ†è‡ªä¸Šæ¬¡å‘å¸ƒä»¥æ¥çš„æ‰€æœ‰åŒ…æˆ–å•ä¸ªåŒ…</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna </span><span class="token function" style="color:#d73a49">diff</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="12-lerna-info">12. lerna info<a class="hash-link" href="#12-lerna-info" title="Direct link to heading">â€‹</a></h3><p>æ‰“å°æœ‰å…³æœ¬åœ°ç¯å¢ƒçš„è°ƒè¯•ä¿¡æ¯ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna info</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="13-lerna-run">13. lerna run<a class="hash-link" href="#13-lerna-run" title="Direct link to heading">â€‹</a></h3><p>åœ¨åŒ…å«è¯¥è„šæœ¬çš„æ¯ä¸ªåŒ…ä¸­è¿è¡Œ npm è„šæœ¬ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna run dev</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>åœ¨åŒ…å«è¯¥è„šæœ¬çš„æŒ‡å®šåŒ…ä¸­è¿è¡Œ npm è„šæœ¬ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna run dev --scope</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">packageA</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="14-lerna-version">14. lerna version<a class="hash-link" href="#14-lerna-version" title="Direct link to heading">â€‹</a></h3><p>æ›´æ–°ç‰ˆæœ¬ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna version</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="äº”lerna--yarn-workspaces-å®è·µ">äº”ã€lerna + yarn workspaces å®è·µ<a class="hash-link" href="#äº”lerna--yarn-workspaces-å®è·µ" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="1-å®‰è£…">1. å®‰è£…<a class="hash-link" href="#1-å®‰è£…" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> lerna -g</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="2-åˆ›å»ºé¡¹ç›®">2. åˆ›å»ºé¡¹ç›®<a class="hash-link" href="#2-åˆ›å»ºé¡¹ç›®" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> lerna-demo</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="3-åˆå§‹åŒ–é¡¹ç›®">3. åˆå§‹åŒ–é¡¹ç›®<a class="hash-link" href="#3-åˆå§‹åŒ–é¡¹ç›®" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> ./lerna-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna init</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>å…¶ä¸­ package.json &amp; lerna.json å¦‚ä¸‹:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">// package.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;private&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true, // ç§æœ‰çš„ï¼Œä¸ä¼šè¢«å‘å¸ƒï¼Œæ˜¯ç®¡ç†æ•´ä¸ªé¡¹ç›®ï¼Œä¸è¦å‘å¸ƒåˆ°npmçš„è§£è€¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;devDependencies&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;lerna&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^4.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// lerna.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;packages&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;packages/*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;version&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="4-å¯ç”¨-yarn-workspaces">4. å¯ç”¨ yarn workspaces<a class="hash-link" href="#4-å¯ç”¨-yarn-workspaces" title="Direct link to heading">â€‹</a></h3><p>å„ä¸ªåº“ä¹‹é—´å­˜åœ¨ä¾èµ–ï¼Œå¦‚ A ä¾èµ–äº Bï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸éœ€è¦å°† B link åˆ° A çš„ node_module é‡Œï¼Œä¸€æ—¦ä»“åº“å¾ˆå¤šçš„è¯ï¼Œæ‰‹åŠ¨çš„ç®¡ç†è¿™äº› link æ“ä½œè´Ÿæ‹…å¾ˆå¤§ï¼Œå› æ­¤éœ€è¦è‡ªåŠ¨åŒ–çš„ link æ“ä½œï¼ŒæŒ‰ç…§æ‹“æ‰‘æ’åºå°†å„ä¸ªä¾èµ–è¿›è¡Œ linkã€‚</p><p>å¯ç”¨ yarn workspaces å¯ä»¥æŠŠæ‰€æœ‰çš„ä¾èµ–æå‡åˆ°é¡¶å±‚çš„ node_modules ä¸­ï¼Œå¹¶ä¸”åœ¨ node_modules ä¸­é“¾æ¥åˆ°æœ¬åœ°çš„ packageï¼Œè‡ªåŠ¨çš„å¸®å¿™è§£å†³å®‰è£…å’Œ link é—®é¢˜ã€‚</p><p>ä¿®æ”¹ package.jsonï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;private&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true, // åªæœ‰ç§æœ‰é¡¹ç›®å¯ä»¥å¼€å¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;workspaces&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;packages/*&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä¿®æ”¹ lerna.jsonï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;useWorkspaces&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;npmClient&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;yarn&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="5-æ·»åŠ -package">5. æ·»åŠ  package<a class="hash-link" href="#5-æ·»åŠ -package" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna create packageA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna create packageB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="6-æ·»åŠ åˆ é™¤æ¸…é™¤åŒ…ä¾èµ–">6. æ·»åŠ ã€åˆ é™¤ã€æ¸…é™¤åŒ…ä¾èµ–<a class="hash-link" href="#6-æ·»åŠ åˆ é™¤æ¸…é™¤åŒ…ä¾èµ–" title="Direct link to heading">â€‹</a></h3><p>yarn workspaces æ·»åŠ ä¾èµ–ï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># å°†packageAä½œä¸ºpackageBçš„ä¾èµ–è¿›è¡Œå®‰è£…ï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspace packageB </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> packageA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ç»™æ‰€æœ‰çš„packageå®‰è£…ä¾èµ–:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspaces </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> lodash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ç»™root å®‰è£…ä¾èµ–ï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> -W -D typescript</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>yarn workspaces åˆ é™¤ä¾èµ–ï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># åˆ é™¤packageBçš„ä¾èµ–packageAï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspace packageB remove packageA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ç»™æ‰€æœ‰çš„packagesåˆ é™¤ä¾èµ–:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspaces remove lodash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ç»™root åˆ é™¤ä¾èµ–ï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> remove -W -D typescript</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>yarn workspaces å®‰è£…å…¨éƒ¨ä¾èµ–ï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>yarn install</code> ç­‰ä»·äº <code>lerna bootstrap --npm-client yarn --use-workspaces</code>ï¼ŒæŠŠæ‰€æœ‰çš„ä¾èµ–æå‡åˆ°é¡¶å±‚çš„ node_modules ä¸­ï¼Œå¹¶ä¸”åœ¨ node_modules ä¸­é“¾æ¥åˆ°æœ¬åœ°çš„ packageï¼Œè‡ªåŠ¨çš„å¸®å¿™è§£å†³å®‰è£…å’Œ link é—®é¢˜ã€‚</p><p>yarn workspaces æ¸…é™¤ node_modulesï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> workspaces run clean</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="7-é¡¹ç›®æ„å»º">7. é¡¹ç›®æ„å»º<a class="hash-link" href="#7-é¡¹ç›®æ„å»º" title="Direct link to heading">â€‹</a></h3><p>æ„å»ºæ‰€æœ‰åŒ…ï¼š</p><p>åŒºåˆ«äºæ™®é€šé¡¹ç›®ä¹‹å¤„åœ¨äºå„ä¸ª package ä¹‹é—´å­˜åœ¨ç›¸äº’ä¾èµ–ï¼Œå¦‚ packageB åªæœ‰åœ¨ packageA æ„å»ºå®Œä¹‹åæ‰èƒ½è¿›è¡Œæ„å»ºï¼Œå¦åˆ™å°±ä¼šå‡ºé”™ï¼Œè¿™å®é™…ä¸Šè¦æ±‚æˆ‘ä»¬ä»¥ä¸€ç§æ‹“æ‰‘æ’åºçš„è§„åˆ™è¿›è¡Œæ„å»ºã€‚</p><p>lerna æ”¯æŒæŒ‰ç…§æ‹“æ‰‘æ’åºè§„åˆ™æ‰§è¡Œå‘½ä»¤, --sort å‚æ•°å¯ä»¥æ§åˆ¶ä»¥æ‹“æ‰‘æ’åºè§„åˆ™æ‰§è¡Œå‘½ä»¤ã€‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ä»¥æ‹“æ‰‘æ’åºè§„åˆ™åœ¨åŒ…å«è¯¥è„šæœ¬çš„æ¯ä¸ªåŒ…ä¸­è¿è¡Œ npm run dev è„šæœ¬ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna run dev --stream --sort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ä»¥æ‹“æ‰‘æ’åºè§„åˆ™åœ¨åŒ…å«è¯¥è„šæœ¬çš„æ¯ä¸ªåŒ…ä¸­è¿è¡Œ npm run build è„šæœ¬ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna run build --stream --sort</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æ„å»ºæŒ‡å®šåŒ…ï¼š</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># åœ¨ packageA åŒ…ä¸­è¿è¡Œ npm run dev è„šæœ¬ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna run dev --stream --scope</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">packageA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># åœ¨ packageA åŒ…ä¸­è¿è¡Œ npm run build è„šæœ¬ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna run build --stream --scope</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">packageA</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="8-å‘å¸ƒ">8. å‘å¸ƒ<a class="hash-link" href="#8-å‘å¸ƒ" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna publish</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>å‘å¸ƒæŒ‡ä»¤ lerna publish å†…ç½®ä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li><p><strong>æ¡ä»¶éªŒè¯</strong>ï¼šåŒ…å«éªŒè¯æµ‹è¯•æ˜¯å¦é€šè¿‡ï¼Œæ˜¯å¦å­˜åœ¨æœªæäº¤çš„ä»£ç ï¼Œæ˜¯å¦åœ¨ä¸»åˆ†æ”¯ä¸Šè¿›è¡Œç‰ˆæœ¬å‘å¸ƒæ“ä½œç­‰ç­‰æ¡ä»¶éªŒè¯ï¼›</p></li><li><p><strong>version_bump</strong>ï¼šå‘ç‰ˆçš„æ—¶å€™éœ€è¦æ›´æ–°ç‰ˆæœ¬å·ï¼Œè¿™æ—¶å€™å¦‚ä½•æ›´æ–°ç‰ˆæœ¬å·å°±æ˜¯ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬å¤§å®¶éƒ½ä¼šéµå¾ª Â semVer è¯­ä¹‰ï¼›</p></li><li><p><strong>ç”Ÿæˆ changelog</strong>ï¼šä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹æ¯ä¸ª package æ¯ä¸ªç‰ˆæœ¬è§£å†³äº†å“ªäº›åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ª package éƒ½ç”Ÿæˆä¸€ä»½ changelog æ–¹ä¾¿ç”¨æˆ·æŸ¥çœ‹å„ä¸ªç‰ˆæœ¬çš„åŠŸèƒ½å˜åŒ–ï¼›</p></li><li><p><strong>ç”Ÿæˆ git tag</strong>ï¼šä¸ºäº†æ–¹ä¾¿åç»­å›æ»šé—®é¢˜åŠé—®é¢˜æ’æŸ¥é€šå¸¸éœ€è¦ç»™æ¯ä¸ªç‰ˆæœ¬åˆ›å»ºä¸€ä¸ª git tagï¼›</p></li><li><p><strong>git å‘å¸ƒç‰ˆæœ¬</strong>ï¼šæ¯æ¬¡å‘ç‰ˆæˆ‘ä»¬éƒ½éœ€è¦å•ç‹¬ç”Ÿæˆä¸€ä¸ª commit è®°å½•æ¥æ ‡è®° milestoneï¼›</p></li><li><p><strong>å‘å¸ƒ npm åŒ…</strong>ï¼šå‘å¸ƒå®Œ git åæˆ‘ä»¬è¿˜éœ€è¦å°†æ›´æ–°çš„ç‰ˆæœ¬å‘å¸ƒåˆ° npm ä¸Šï¼Œä»¥ä¾¿å¤–éƒ¨ç”¨æˆ·ä½¿ç”¨ã€‚</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="å°ç»“">å°ç»“<a class="hash-link" href="#å°ç»“" title="Direct link to heading">â€‹</a></h2><p>æœ¬æ–‡ä» 5 ä¸ªæ–¹é¢ä»‹ç»äº† lernaï¼š</p><ul><li>èƒŒæ™¯</li><li>ä»‹ç»</li><li>å·¥ä½œæ¨¡å¼</li><li>å¸¸ç”¨æŒ‡ä»¤</li><li>lerna + yarn workspaces å®è·µ</li></ul><p>ç›¸ä¿¡ä½ å·²ç»å¾ˆç†Ÿæ‚‰ lerna çš„ä½¿ç”¨äº†ï¼Œä¸‹æ–¹è¿˜åˆ—ä¸¾äº†å‚è€ƒèµ„æ–™ï¼Œå¯ä»¥è‡ªè¡Œæ‰©å±•é˜…è¯»ã€‚</p><p>å¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæ„Ÿè°¢é˜…è¯»ï½</p><p>åˆ«å¿˜äº†ç‚¹ä¸ªèµé¼“åŠ±ä¸€ä¸‹æˆ‘å“¦ï¼Œç¬”èŠ¯ â¤ï¸</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™<a class="hash-link" href="#å‚è€ƒèµ„æ–™" title="Direct link to heading">â€‹</a></h2><ul><li><a href="https://juejin.cn/post/6844903568751722509" target="_blank" rel="noopener noreferrer">lerna ç®¡ç†å‰ç«¯æ¨¡å—æœ€ä½³å®è·µ</a></li><li><a href="https://juejin.cn/post/6844903856153821198" target="_blank" rel="noopener noreferrer">Lerna ä¸­æ–‡æ•™ç¨‹è¯¦è§£</a></li><li><a href="https://www.lernajs.cn/" target="_blank" rel="noopener noreferrer">Lerna ä¸­æ–‡å®˜ç½‘</a></li><li><a href="https://segmentfault.com/a/1190000023954051" target="_blank" rel="noopener noreferrer">Lerna --å¤šåŒ…å­˜å‚¨ç®¡ç†å·¥å…·ï¼ˆä¸€ï¼‰</a></li><li><a href="https://juejin.cn/post/7043998041786810398" target="_blank" rel="noopener noreferrer">One For Allï¼šåŸºäº pnpm + lerna + typescript çš„æœ€ä½³é¡¹ç›®å®è·µ - ç†è®ºç¯‡</a></li><li><a href="https://juejin.cn/post/6844903918279852046" target="_blank" rel="noopener noreferrer">lerna+yarn workspace+monorepo é¡¹ç›®çš„æœ€ä½³å®è·µ</a></li><li><a href="https://juejin.cn/post/6847902224987717639" target="_blank" rel="noopener noreferrer">@lerna/run(ç¿»è¯‘)</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022.08.14-hooks"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« <!-- -->2022.08.14-hooks</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022.6.13-module-federation"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">æµ…å­¦ä¸€ä¸‹ webpack5 module federation<!-- --> Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ä¸€èƒŒæ™¯" class="table-of-contents__link toc-highlight">ä¸€ã€èƒŒæ™¯</a></li><li><a href="#äºŒlerna-ä»‹ç»" class="table-of-contents__link toc-highlight">äºŒã€lerna ä»‹ç»</a></li><li><a href="#ä¸‰å·¥ä½œæ¨¡å¼" class="table-of-contents__link toc-highlight">ä¸‰ã€å·¥ä½œæ¨¡å¼</a><ul><li><a href="#é»˜è®¤æ¨¡å¼-locked-mode" class="table-of-contents__link toc-highlight">é»˜è®¤æ¨¡å¼-Locked mode</a></li><li><a href="#independent-mode" class="table-of-contents__link toc-highlight">Independent mode</a></li></ul></li><li><a href="#å››å¸¸ç”¨æŒ‡ä»¤" class="table-of-contents__link toc-highlight">å››ã€å¸¸ç”¨æŒ‡ä»¤</a><ul><li><a href="#1-lerna-init" class="table-of-contents__link toc-highlight">1. lerna init</a></li><li><a href="#2-lerna-create" class="table-of-contents__link toc-highlight">2. lerna create</a></li><li><a href="#3-lerna-add" class="table-of-contents__link toc-highlight">3. lerna add</a></li><li><a href="#4-lerna-bootstrap" class="table-of-contents__link toc-highlight">4. lerna bootstrap</a></li><li><a href="#5-lerna-list" class="table-of-contents__link toc-highlight">5. lerna list</a></li><li><a href="#6-lerna-import" class="table-of-contents__link toc-highlight">6. lerna import</a></li><li><a href="#7-lerna-link" class="table-of-contents__link toc-highlight">7. lerna link</a></li><li><a href="#8-lerna-clean" class="table-of-contents__link toc-highlight">8. lerna clean</a></li><li><a href="#9-lerna-changed" class="table-of-contents__link toc-highlight">9. lerna changed</a></li><li><a href="#10-lerna-publish" class="table-of-contents__link toc-highlight">10. lerna publish</a></li><li><a href="#11-lerna-diff" class="table-of-contents__link toc-highlight">11. lerna diff</a></li><li><a href="#12-lerna-info" class="table-of-contents__link toc-highlight">12. lerna info</a></li><li><a href="#13-lerna-run" class="table-of-contents__link toc-highlight">13. lerna run</a></li><li><a href="#14-lerna-version" class="table-of-contents__link toc-highlight">14. lerna version</a></li></ul></li><li><a href="#äº”lerna--yarn-workspaces-å®è·µ" class="table-of-contents__link toc-highlight">äº”ã€lerna + yarn workspaces å®è·µ</a><ul><li><a href="#1-å®‰è£…" class="table-of-contents__link toc-highlight">1. å®‰è£…</a></li><li><a href="#2-åˆ›å»ºé¡¹ç›®" class="table-of-contents__link toc-highlight">2. åˆ›å»ºé¡¹ç›®</a></li><li><a href="#3-åˆå§‹åŒ–é¡¹ç›®" class="table-of-contents__link toc-highlight">3. åˆå§‹åŒ–é¡¹ç›®</a></li><li><a href="#4-å¯ç”¨-yarn-workspaces" class="table-of-contents__link toc-highlight">4. å¯ç”¨ yarn workspaces</a></li><li><a href="#5-æ·»åŠ -package" class="table-of-contents__link toc-highlight">5. æ·»åŠ  package</a></li><li><a href="#6-æ·»åŠ åˆ é™¤æ¸…é™¤åŒ…ä¾èµ–" class="table-of-contents__link toc-highlight">6. æ·»åŠ ã€åˆ é™¤ã€æ¸…é™¤åŒ…ä¾èµ–</a></li><li><a href="#7-é¡¹ç›®æ„å»º" class="table-of-contents__link toc-highlight">7. é¡¹ç›®æ„å»º</a></li><li><a href="#8-å‘å¸ƒ" class="table-of-contents__link toc-highlight">8. å‘å¸ƒ</a></li></ul></li><li><a href="#å°ç»“" class="table-of-contents__link toc-highlight">å°ç»“</a></li><li><a href="#å‚è€ƒèµ„æ–™" class="table-of-contents__link toc-highlight">å‚è€ƒèµ„æ–™</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8b388713.js"></script>
<script src="/assets/js/main.c7c69549.js"></script>
</body>
</html>